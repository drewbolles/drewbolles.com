{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog","author":"Kyle Mathews"}},"markdownRemark":{"id":"618e6390-ccac-559f-8886-da9cc966326f","excerpt":"When building a modern  React  application, the sanest starting point is Facebook’s official  Create React App . It’s well documented, well…","html":"<p>When building a modern <a href=\"https://facebook.github.io/react/\">React</a> application, the sanest starting point is Facebook’s official <a href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a>. It’s well documented, well built, and makes getting started building with React simple and streamlined. Their custom <a href=\"https://webpack.github.io/\">Webpack</a> configuration is everything you need to get started, from Hot Module Reloading, to production minification and gzipping. One of the things they don’t outline, however, and is super vital to production-quality applications is <strong>code splitting</strong>. This is the process of breaking up your JavaScript to only load what is necessary, and async load in the rest.</p>\n<p><a href=\"http://webpack.github.io/docs/code-splitting.html\">Code Splitting</a> is a default feature of Webpack, it’s just not built into Create React App, and for good reason. React by default is the view layer to your application, it doesn’t care about routes, or chunks, or anything else really. Enter <a href=\"https://github.com/ReactTraining/react-router\">React Router</a>. Used on ~40% of React applications, React Router is the most popular routing solution for React. They make <strong>dynamic routes</strong> and <strong>route-based code splitting</strong> exceedingly straight forward. In fact, <strong>simply copying the technique from their “Huge Apps” example works out of the box with Create React App.</strong> That’s right, if you’re familiar with declarative route-based splitting with React Router already, then you can stop reading and start splitting!</p>\n<p>If you’re still with me, I’m talking about this example here: <a href=\"https://github.com/ReactTraining/react-router/tree/master/examples/huge-apps\">Huge Apps</a>. This awesome repository is all that we need to get code splitting up and working with any Create React App application. The process involves two steps: segmenting your route components from core components, and utilizing <code class=\"language-text\">getComponent</code> with <code class=\"language-text\">require.ensure</code>. It’s very straight forward, the guys at ReactTraining outline it well here: <a href=\"https://github.com/ReactTraining/react-router/blob/master/docs/guides/DynamicRouting.md\">Dynamic Routing</a>.</p>\n<p>Your <code class=\"language-text\">rootRoute</code> object would look similar to this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> rootRoute <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  childRoutes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      path<span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n      component<span class=\"token punctuation\">:</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./components/App'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      childRoutes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./routes/Calendar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./routes/Course'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./routes/Grades'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./routes/Messages'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./routes/Profile'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This contains the parent <code class=\"language-text\">App</code> component, and all the primary child routes of your application. This commonly lives in <code class=\"language-text\">App.js</code> or <code class=\"language-text\">/config/routes.js</code>.</p>\n<p>The rest of your folder structure would look something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\">/src\n  index.js\n  /components\n    App.js\n    Calendar.js\n  /routes\n    /Calendar\n      index.js</code></pre></div>\n<p>An example individual route index file looks like:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  path<span class=\"token punctuation\">:</span> <span class=\"token string\">'calendar'</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">getComponent</span><span class=\"token punctuation\">(</span>nextState<span class=\"token punctuation\">,</span> cb<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    require<span class=\"token punctuation\">.</span><span class=\"token function\">ensure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> require <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./components/Calendar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>And that’s it! The <code class=\"language-text\">getComponent</code> function allows us to call the require.ensure function to load our route component only when needed. Again, this is just leveraging built in Webpack functionality.</p>\n<p>Super straight forward technique that I use on every create react app build (that uses React Router 2/3 at least!). This could be more concise with the <code class=\"language-text\">bundle-loader</code> Webpack plugin, but that would require us to eject Create React App. Still, using this method saved me over 60% on my initial JS load! It’s too easy to not use.</p>","frontmatter":{"title":"Webpack code splitting with Create React App and React Router","date":"November 14, 2016"}}},"pageContext":{"slug":"/blog/2016/11/14/webpack-code-splitting-with-create-react-app-react-router/","previous":{"fields":{"slug":"/blog/2016/01/14/i-was-featured-in-lullabots-drupal-8-podcast/"},"frontmatter":{"title":"I was featured in Lullabot's recent Drupal 8 podcast!"}},"next":null}}