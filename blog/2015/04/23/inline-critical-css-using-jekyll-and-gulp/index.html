<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/0.014ac8b73a721d356678.css">/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}</style><style data-href="/app.ff93035319d90e441538.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}</style><meta name="generator" content="Gatsby 2.0.19"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><title data-react-helmet="true">Inline your critical CSS using Jekyll and Gulp | Drew Bolles</title><meta data-react-helmet="true" name="description" content="If you’re familiar with critical CSS and its impact on web performance, you also know it’s not the simpliest thing to work with.  Google’s…"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style id="__jsx-3725441931">.container.jsx-3725441931{max-width:1008px;margin-right:auto;margin-left:auto;padding-right:16px;padding-left:16px;}
@media (min-width:768px){.container.jsx-3725441931{padding-right:24px;padding-left:24px;}}</style><style id="__jsx-1166761398">.site-header.jsx-1166761398{padding:4px 0;background-color:#222;color:#fff;}
.site-header-inner.jsx-1166761398{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
.site-header.jsx-1166761398 a{color:inherit;}
.site-title{font-size:24px;line-height:56px;}
.site-nav.jsx-1166761398{margin-left:auto;}
.site-nav-link{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:56px;padding:0 8px;}
@media (min-width:768px){.site-nav-link{padding:0 16px;}}</style><style id="__jsx-1535843472">p.typography--large.jsx-1535843472{margin-bottom:24px;font-size:18px;}
h2.typography--large.jsx-1535843472{font-size:30px;}
.typography--variant-caps.jsx-1535843472{text-transform:uppercase;}
@media (min-width:992px){h2.typography--large.jsx-1535843472{font-size:45px;}}</style><style id="__jsx-1006987749">.share-list.jsx-1006987749{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0;list-style:none;}
.share-list-item.jsx-1006987749,.share-list-item.jsx-1006987749 a.jsx-1006987749{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;line-height:24px;}
.share-list-item.jsx-1006987749+.share-list-item.jsx-1006987749{margin-left:8px;}</style><style id="__jsx-595061220">.box.jsx-595061220{padding:8px 0;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);}</style><style id="__jsx-3654914441">.post-content.jsx-3654914441 h3{margin:24px 0;}</style><style id="__jsx-2785131178">.visually-hidden.jsx-2785131178{width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;position:absolute !important;overflow:hidden !important;border:0 !important;-webkit-clip:rect(0 0 0 0) !important;clip:rect(0 0 0 0) !important;}</style><style id="__jsx-3098354237">.slice.jsx-3098354237{padding:24px 0;}
.slice--center.jsx-3098354237{text-align:center;}
.slice--bg-green.jsx-3098354237{background-color:#2e7d32;}
.slice--bg-green.jsx-3098354237 a{color:#fff;}
.slice--bg-grey.jsx-3098354237{background-color:#f5f5f5;border:1px solid #e0e0e0;border-width:1px 0;}
@media (min-width:768px){.slice.jsx-3098354237{padding:48px 0;}.slice--variant-callout.jsx-3098354237{padding:72px 0;}}</style><style id="__jsx-3758082037">.social-media-list.jsx-3758082037{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0;padding:0;list-style:none;}
.social-media-list__item.jsx-3758082037{-webkit-flex:1 0 0;-ms-flex:1 0 0;flex:1 0 0;color:#fff;text-align:center;}
.footer-col-wrapper.jsx-3758082037{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}
.footer-col.jsx-3758082037{-webkit-flex:1 0 0;-ms-flex:1 0 0;flex:1 0 0;}
.footer-info.jsx-3758082037 a.jsx-3758082037{color:#2e7d32;}</style><style id="__jsx-3175556483">*,::before,::after{box-sizing:inherit;}
html{font-size:100%;box-sizing:border-box;}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto, Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-size:1rem;font-weight:300;line-height:1.6;}
h1,h2,h3,h4,h5,h6,p,ol,ul,blockquote{margin-top:0;margin-bottom:12px;}
h1,h2,h3,h4,h5,h6{font-family:'Roboto Slab',Georgia,serif;line-height:1.2;}
a{color:#2e7d32;-webkit-text-decoration:none;text-decoration:none;}
strong{font-weight:700;}
img{max-width:100%;vertical-align:middle;}
.image-source{font-size:12px;color:#9e9e9e;}</style><link as="script" rel="preload" href="/0-3728636181e81b70df77.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-297eae5cbbfda96da690.js"/><link as="script" rel="preload" href="/1-a7c7a578685302f688ec.js"/><link as="script" rel="preload" href="/app-9212f6833c68163ae2e1.js"/><link as="script" rel="preload" href="/webpack-runtime-bd4fb6a9b5520ba4043b.js"/><link rel="preload" href="/static/d/11/path---blog-2015-04-23-inline-critical-css-using-jekyll-and-gulp-079-917-NNGjGY9dOkSNynuKRQJefvovNWI.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="jsx-3175556483 site site--type-blog"><header class="jsx-1166761398 site-header"><div class="jsx-3725441931 container"><div class="jsx-1166761398 site-header-inner"><a class="site-title" href="/">Drew Bolles</a><nav class="jsx-1166761398 site-nav"><a class="site-nav-link" href="/about">About</a><a class="site-nav-link" href="/portfolio">Portfolio</a><a class="site-nav-link" href="/blog">Blog</a></nav></div></div></header><main class="jsx-3175556483 site-main"><header style="padding:48px 0 24px" class="jsx-3175556483 page-header"><div class="jsx-3725441931 container"><h1 style="margin:0" class="jsx-3175556483 page-title">Inline your critical CSS using Jekyll and Gulp</h1><p style="margin:12px 0 0;color:#757575" class="jsx-1535843472 typography typography--large">April 23, 2015</p></div></header><div class="jsx-3175556483 page"><div class="jsx-3725441931 container"><ul class="jsx-1006987749 share-list"><li class="jsx-1006987749 share-list-item"><strong style="margin:0" class="jsx-1535843472 typography typography--variant-caps">Share:</strong></li><li class="jsx-1006987749 share-list-item"><a href="http://www.facebook.com/share.php?u=https://www.drewbolles.com/blog/2015/04/23/inline-critical-css-using-jekyll-and-gulp/&amp;t=Inline your critical CSS using Jekyll and Gulp" aria-label="Share on Facebook" class="jsx-1006987749"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" size="24" height="24" width="24"><path d="M448 56.7v398.5c0 13.7-11.1 24.7-24.7 24.7H309.1V306.5h58.2l8.7-67.6h-67v-43.2c0-19.6 5.4-32.9 33.5-32.9h35.8v-60.5c-6.2-.8-27.4-2.7-52.2-2.7-51.6 0-87 31.5-87 89.4v49.9h-58.4v67.6h58.4V480H24.7C11.1 480 0 468.9 0 455.3V56.7C0 43.1 11.1 32 24.7 32h398.5c13.7 0 24.8 11.1 24.8 24.7z"></path></svg></a></li><li class="jsx-1006987749 share-list-item"><a href="https://twitter.com/intent/tweet?original_referer=www.drewbolles.com&amp;source=tweetbutton&amp;text=Inline your critical CSS using Jekyll and Gulp&amp;url=https://www.drewbolles.com/blog/2015/04/23/inline-critical-css-using-jekyll-and-gulp/&amp;via=bollskis" aria-label="Share on Twitter" class="jsx-1006987749"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" size="24" height="24" width="24"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li></ul><div style="margin-bottom:24px" class="jsx-595061220 box"><div style="padding:16px;font-size:18px" class="jsx-3654914441 post-content"><p>If you’re familiar with critical CSS and its impact on web performance, you also know it’s not the simpliest thing to work with. <a href="https://developers.google.com/speed/pagespeed/insights/">Google’s pagespeed insights</a> recommends that you inline any critical, render blocking content to increase performance, which can be tricky. I’ve managed to set up this up using Jekyll and Gulp to generate and include my critical CSS, and in this post I’ll walk you through how I did that.</p>
<h2>Requirements</h2>
<p>For this you’ll need a few things.</p>
<ul>
<li>A <a href="http://jekyllrb.com">Jekyll</a> site</li>
<li><a href="http://nodejs.org">Node.js</a> and npm</li>
<li><a href="http://sass-lang.com">Sass</a></li>
<li><a href="http://gulpjs.com">Gulp</a></li>
<li><a href="https://github.com/filamentgroup/loadCSS">loadCSS</a></li>
<li>Command line familiarity</li>
</ul>
<h2>The set up</h2>
<p>The process for inlining your critical CSS isn’t complicated, it’s just specific. There are two parts <strong>1)</strong> include the critical CSS at the top of your document head in <code class="language-text">&lt;style&gt;</code> tags <strong>2)</strong> asychronously load the full CSS file in the footer. Using Gulp and Jekyll together makes this suprisingly simple.</p>
<h3>Gulp</h3>
<p>Once you have node installed on your machine, you can install Gulp locally to manage the build. Make sure you are in your site root <code class="language-text">$ cd /path/to/site</code> then run <code class="language-text">$ npm init</code>. Fill out the fields as they make sense, you can mostly hit enter. Next we need a few node modules to get things cooking. Namely, gulp, gulp-sass, critical, gulp-watch. Non-essential, but nice-to-haves are gulp-autoprefixer, and gulp-sourcemaps.</p>
<p>You can install all of them by running <code class="language-text">$ npm i --save-dev gulp gulp-sass gulp-autoprefixer gulp-sourcemaps gulp-watch critical</code>.</p>
<p>Once the packages are done downloading, we need to set up our Gulpfile. Create a file in the root of your project named Gulpfile.js. Mine looks like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Require Gulp</span>
<span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-sass'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sourcemaps <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-sourcemaps'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> prefix <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> watch <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-watch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> critical <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'critical'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Gulp Sass Task</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'sass'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp
    <span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'_sass/*_/_.scss'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>sourcemaps<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Initializes sourcemaps</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">sass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        errLogToConsole<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        outputStyle<span class="token punctuation">:</span> <span class="token string">'compressed'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">prefix</span><span class="token punctuation">(</span><span class="token string">'last 2 versions'</span><span class="token punctuation">,</span> <span class="token string">'> 1%'</span><span class="token punctuation">,</span> <span class="token string">'ie 8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>sourcemaps<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> Writes sourcemaps into the <span class="token constant">CSS</span> file
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'critical'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  critical<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    base<span class="token punctuation">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span>
    src<span class="token punctuation">:</span> <span class="token string">'_site/index.html'</span><span class="token punctuation">,</span>
    css<span class="token punctuation">:</span> <span class="token string">'_site/css/screen.css'</span><span class="token punctuation">,</span>
    dest<span class="token punctuation">:</span> <span class="token string">'_includes/critical.css'</span><span class="token punctuation">,</span>
    width<span class="token punctuation">:</span> <span class="token number">320</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token number">480</span><span class="token punctuation">,</span>
    minify<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'watch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">'_sass/*_/_.scss'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'sass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'sass'</span><span class="token punctuation">,</span> <span class="token string">'watch'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>So what we have here, is two tasks, one to compile our Sass, the other to build our critical styles. The Gulp task for our Sass will watch any files in the <code class="language-text">_sass</code> directory, and write them to the <code class="language-text">css</code> folder. This means that we’re not using Jekyll’s ability to process Sass as part of the build. We’re going to be watching and compiling our Sass outside of Jekyll.</p>
<h3>Jekyll files</h3>
<p>With out Gulp set up to compile our Sass into CSS and generate our critical CSS, we need to adjust our Jekyll templates. What we want to do is line both the critical CSS as well as the loadCSS javascript function. LoadCSS.js is so small that it makes sense to inline it rather than create another http request. In order to do this, we need to place loadCSS.js into the <code class="language-text">_includes</code> folder of our Jekyll site. Since our Gulp task is creating our critical styles for us, we just need to include the file in our templates. We then need to load our CSS in the footer of our site. It looks something like this (notice the {% include critical.css %}).</p>
<p>head.html</p>
<div class="gatsby-highlight" data-language="markup"><pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

  <span class="token comment">&lt;!-- Inline critical css --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style language-css"><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token selector">"</span><span class="token punctuation">{</span>% include critical.css "<span class="token punctuation">}</span><span class="token punctuation">}</span>%<span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>canonical<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{ page.url | replace:<span class="token punctuation">'</span>index.html<span class="token punctuation">'</span>,<span class="token punctuation">'</span><span class="token punctuation">'</span> | prepend: site.baseurl | prepend: site.url }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  &lt;link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ "/feed.xml" | prepend: site.baseurl | prepend: site.url }}" />
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image/x-icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/favicon.ico<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token comment">&lt;!--[if lt IE 9]>
    &lt;script src="{{ "js/html5shiv.js" | prepend: site.baseurl }}">&lt;/script>
  &lt;![endif]--></span>

  <span class="token comment">&lt;!-- Load CSS --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token string">"{% include loadCSS.js "</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">%</span><span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></code></pre></div>
<p>footer.html</p>
<div class="gatsby-highlight" data-language="markup"><pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>site-footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>footer-col-wrapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>footer-col footer-col-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>contact-list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mailto:{{ site.email }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>{{ site.email }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>{{ site.description }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>footer-col footer-col-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>copyright<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Built with <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://jekyllrb.com<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Jeykll<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>. Hosted on <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://github.com/drewbolles/drewbolles-jekyll<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>GitHub Pages<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token entity" title="&copy;">&amp;copy;</span> Copyright 2015 All Rights Reserved<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- Loadd css --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token function">loadCSS</span><span class="token punctuation">(</span><span class="token string">'/css/screen.css'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'screen'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/css/screen.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">></span></span></code></pre></div>
<h3>Workflow</h3>
<p>Once our Gulpfile.js is set up, we basically have everything we need. The workflow becomes a bit more complicated, though, since we have to watch for both Sass AND Jekyll changes, and I’ve not set up the Gulp file to do both.</p>
<p>For simplicity sake, what I do is have multiple terminal windows running, three to be exact. I use iTerm2 and it’s split-pane feature. My top pane is for my git / bower / vim commands. I then have a pane below running <code class="language-text">$ gulp</code> and another pane below that running <code class="language-text">$ jekyll serve</code>. Any time I make a change to my Sass, Gulp outputs a new CSS file, which Jekyll picks up and rebuilds its static content from. It’s one more watch step, but it’s fast and simple.</p>
<p>Once I’m ready to push my changes to the repo, I generate my critical CSS. I do this by running <code class="language-text">$ gulp critical</code>. Once the task is done a file is created at <code class="language-text">_includes/critical.css</code>. We include this in a commit, and push it to the repo (on the gh-pages branch or master for orgs, etc). GitHub pages works its magic and builds our site out with our crictcal CSS inline!</p>
<h2>Results</h2>
<p>Once we have our Gulp file set up to build our Sass and critical CSS, and our Jekyll files are using our new assets, we can sit back and enjoy good performance results. Head on over to <a href="https://developers.google.com/speed/pagespeed/insights/">Google’s pagespeed insights</a> and run your site through it’s test. It should report back that you’ve done everything correctly!</p></div></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;margin-bottom:24px;padding:0" class="jsx-3654914441"><li class="jsx-3654914441"><a rel="prev" href="/blog/2014/09/01/joining-chapter-three/">← <!-- -->I&#x27;m joining Chapter Three!</a></li><li class="jsx-3654914441"><a rel="next" href="/blog/2016/01/13/getting-started-with-drupal-8-theming/">Getting started with Drupal 8 Theming<!-- --> →</a></li></ul></div></div></main><footer role="contentinfo" class="jsx-3758082037 site-footer"><div class="jsx-3098354237 slice slice--bg-green"><div class="jsx-3725441931 container"><ul class="jsx-3758082037 social-media-list"><li class="jsx-3758082037 social-media-list__item"><a href="http://github.com/drewbolles" title="My GitHub" class="jsx-3758082037"><span class="jsx-2785131178 visually-hidden"><strong class="jsx-3758082037">My Github</strong></span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" size="50" height="50" width="50"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li class="jsx-3758082037 social-media-list__item"><a href="http://codepen.io/bollskis" title="My Codepen" class="jsx-3758082037"><span class="jsx-2785131178 visually-hidden"><strong class="jsx-3758082037">My Codepen</strong></span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" size="50" height="50" width="50"><path d="M502.285 159.704l-234-156c-7.987-4.915-16.511-4.96-24.571 0l-234 156C3.714 163.703 0 170.847 0 177.989v155.999c0 7.143 3.714 14.286 9.715 18.286l234 156.022c7.987 4.915 16.511 4.96 24.571 0l234-156.022c6-3.999 9.715-11.143 9.715-18.286V177.989c-.001-7.142-3.715-14.286-9.716-18.285zM278 63.131l172.286 114.858-76.857 51.429L278 165.703V63.131zm-44 0v102.572l-95.429 63.715-76.857-51.429L234 63.131zM44 219.132l55.143 36.857L44 292.846v-73.714zm190 229.715L61.714 333.989l76.857-51.429L234 346.275v102.572zm22-140.858l-77.715-52 77.715-52 77.715 52-77.715 52zm22 140.858V346.275l95.429-63.715 76.857 51.429L278 448.847zm190-156.001l-55.143-36.857L468 219.132v73.714z"></path></svg></a></li><li class="jsx-3758082037 social-media-list__item"><a href="http://twitter.com/bollskis" title="My Twitter" class="jsx-3758082037"><span class="jsx-2785131178 visually-hidden"><strong class="jsx-3758082037">My Twitter</strong></span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" size="50" height="50" width="50"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li></ul></div></div><div style="padding:24px 0;font-size:12px;background-color:#f5f5f5" class="jsx-3758082037 footer-info"><div class="jsx-3725441931 container"><div class="jsx-3758082037 footer-col-wrapper"><div class="jsx-3758082037 footer-col footer-col-1"><ul style="margin:0;padding:0;list-style:none" class="jsx-3758082037 contact-list"><li class="jsx-3758082037"><a href="mailto:drewbolles@gmail.com" class="jsx-3758082037">drewbolles@gmail.com</a></li><li class="jsx-3758082037">I am a passionate UI Engineer currently living in Delray Beach, FL.</li></ul></div><div style="text-align:right" class="jsx-3758082037 footer-col footer-col-2"><p style="margin:0" class="jsx-1535843472 typography copyright">Built with <a href="https://www.gatsbyjs.org" class="jsx-3758082037">Gatsby</a>. Hosted on<!-- --> <a href="http://github.com/drewbolles/drewbolles.com" class="jsx-3758082037">GitHub Pages</a>.<br class="jsx-3758082037"/>All Rights Reserved</p></div></div></div></div></footer></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-36427500-1', 'auto', {});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"blog-2015-04-23-inline-critical-css-using-jekyll-and-gulp-079","path":"/blog/2015/04/23/inline-critical-css-using-jekyll-and-gulp/"};window.dataPath="11/path---blog-2015-04-23-inline-critical-css-using-jekyll-and-gulp-079-917-NNGjGY9dOkSNynuKRQJefvovNWI";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.ff93035319d90e441538.css","/app-9212f6833c68163ae2e1.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-554ad6c315bad65ba8cc.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-297eae5cbbfda96da690.js"],"component---src-pages-404-js":["/component---src-pages-404-js-7f0c48a4a28f646859d7.js"],"component---src-pages-about-js":["/component---src-pages-about-js-692f68e27550b58d4dd5.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-05c6330b01c913ba460d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-21378be8fed75c5d2d93.js"],"component---src-pages-portfolio-js":["/component---src-pages-portfolio-js-205349c0429eb70ee87f.js"]};/*]]>*/</script><script src="/webpack-runtime-bd4fb6a9b5520ba4043b.js" async=""></script><script src="/app-9212f6833c68163ae2e1.js" async=""></script><script src="/1-a7c7a578685302f688ec.js" async=""></script><script src="/component---src-templates-blog-post-js-297eae5cbbfda96da690.js" async=""></script><script src="/0-3728636181e81b70df77.js" async=""></script></body></html>